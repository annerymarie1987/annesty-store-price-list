<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Annesty Store Price List</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- BOOTSTRAP CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    body { background:#f8f9fa; }
    .table thead { background:#0d6efd; color:white; }
</style>
</head>

<body class="p-3">

<h2 class="text-center mb-4">Annesty Store Price List</h2>

<!-- TABS -->
<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="price-tab" data-bs-toggle="tab" data-bs-target="#price" type="button" role="tab">Price List</button>
  </li>

  <li class="nav-item" role="presentation">
    <button class="nav-link" id="bnpl-tab" data-bs-toggle="tab" data-bs-target="#bnpl" type="button" role="tab">Buy Now Pay Later Log</button>
  </li>
</ul>

<div class="tab-content mt-3" id="myTabContent">

<!-- ============ PRICE LIST TAB ============ -->
<div class="tab-pane fade show active" id="price" role="tabpanel">

    <!-- SEARCH -->
    <input type="text" id="searchInput" class="form-control mb-3" placeholder="Search product...">

    <table class="table table-bordered" id="priceTable">
        <thead>
            <tr>
                <th>Description</th>
                <th>Category</th>
                <th>Office Price</th>
            </tr>
        </thead>
        <tbody>
            <tr><td>Nescafe Original Twin</td><td>DRINK</td><td>20</td></tr>
            <tr><td>Nescafe Creamy Latte Twin</td><td>DRINK</td><td>20</td></tr>
            <tr><td>Kopiko Brown Twin</td><td>DRINK</td><td>20</td></tr>
            <tr><td>Kopiko Blanca Twin</td><td>DRINK</td><td>20</td></tr>
            <tr><td>Hiho Crunchy</td><td>SNACKS</td><td>3</td></tr>
            <tr><td>Nissin Noodles Cheese</td><td>NOODLES</td><td>30</td></tr>
            <tr><td>Nissin Noodles Creamy</td><td>NOODLES</td><td>30</td></tr>
            <tr><td>Nissin Noodles Spicy</td><td>NOODLES</td><td>30</td></tr>
            <tr><td>Nissin Noodles Seafood</td><td>NOODLES</td><td>30</td></tr>
            <tr><td>Mr Chips</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Tortillos Barbeque</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>CrisCross</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Alibaba Chips</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Super Crunch</td><td>SNACKS</td><td>3</td></tr>
            <tr><td>Tortillos Cheese</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Pier20 Prawn</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Nova</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Peewee</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Xsakto</td><td>SNACKS</td><td>3</td></tr>
            <tr><td>BoyBawang Small</td><td>SNACKS</td><td>3</td></tr>
            <tr><td>Tostas</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Chippy</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Clover</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Tomi</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Tostillas</td><td>SNACKS</td><td>30</td></tr>
            <tr><td>Vcut</td><td>SNACKS</td><td>30</td></tr>
            <tr><td>Piatos</td><td>SNACKS</td><td>30</td></tr>
            <tr><td>Happy Peanuts Small</td><td>SNACKS</td><td>5</td></tr>
            <tr><td>Pinatsu Seaweed</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Pinatsu Garlic</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>Great Taste White</td><td>SNACKS</td><td>20</td></tr>
            <tr><td>San Mig Coffee</td><td>DRINK</td><td>15</td></tr>
            <tr><td>Nissin Noodles Beef</td><td>NOODLES</td><td>20</td></tr>
            <tr><td>Nissin Noodles Chicken</td><td>NOODLES</td><td>20</td></tr>
            <tr><td>Matcha</td><td>DRINK</td><td>20</td></tr>
            <tr><td>Milo</td><td>DRINK</td><td>15</td></tr>
        </tbody>
    </table>
</div>

<!-- ============ BNPL TAB ============ -->
<div class="tab-pane fade" id="bnpl" role="tabpanel">

    <h4>Add Buy Now Pay Later Log</h4>

    <div class="card p-3 mb-3">
        <label>Name:</label>
        <input type="text" id="bnplName" class="form-control mb-2">

        <label>Date:</label>
        <input type="date" id="bnplDate" class="form-control mb-3">

        <div id="itemContainer">
            <!-- dynamic items appear here -->
        </div>

        <button class="btn btn-secondary mb-2" id="addItemBtn">+ Add Item</button>
        <button class="btn btn-primary" id="addLogBtn">Add Log</button>
    </div>

    <!-- SEARCH BNPL -->
    <input type="text" id="bnplSearchInput" class="form-control mb-2" placeholder="Search BNPL entries">

    <button class="btn btn-success mb-3" id="downloadCsvBtn">Download CSV</button>

    <table class="table table-bordered" id="bnplTable">
        <thead>
            <tr>
                <th>Name</th>
                <th>Item</th>
                <th>Cost</th>
                <th>Date</th>
                <th>Status</th>
                <th>Mark as Paid</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

</div>

</div> <!-- END tab-content -->

<!-- BOOTSTRAP JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
// SEARCH PRICE LIST
document.getElementById("searchInput").addEventListener("keyup", function () {
    const value = this.value.toLowerCase();
    const rows = document.querySelectorAll("#priceTable tbody tr");
    rows.forEach(tr => {
        tr.style.display = tr.textContent.toLowerCase().includes(value) ? "" : "none";
    });
});

// BNPL ITEM DROPDOWN
const products = {
    "Nescafe Original Twin":20, "Nescafe Creamy Latte Twin":20,
    "Kopiko Brown Twin":20, "Kopiko Blanca Twin":20,
    "Hiho Crunchy":3, "Nissin Noodles Cheese":30,
    "Nissin Noodles Creamy":30, "Nissin Noodles Spicy":30,
    "Nissin Noodles Seafood":30, "Mr Chips":20,
    "Tortillos Barbeque":20, "CrisCross":20,
    "Alibaba Chips":20, "Super Crunch":3,
    "Tortillos Cheese":20, "Pier20 Prawn":20,
    "Nova":20, "Peewee":20, "Xsakto":3,
    "BoyBawang Small":3, "Tostas":20,
    "Chippy":20, "Clover":20,
    "Tomi":20, "Tostillas":30, "Vcut":30,
    "Piatos":30, "Happy Peanuts Small":5,
    "Pinatsu Seaweed":20, "Pinatsu Garlic":20,
    "Great Taste White":20, "San Mig Coffee":15,
    "Nissin Noodles Beef":30, "Nissin Noodles Chicken":30,
    "Matcha":20, "Milo":15
};

function createItemRow() {
    const div = document.createElement("div");
    div.classList.add("row", "mb-2");
    div.innerHTML = `
        <div class="col-8">
            <select class="form-select bnpl-item">
                ${Object.keys(products).map(p => `<option value="${p}">${p}</option>`).join("")}
            </select>
        </div>
        <div class="col-4">
            <input type="number" class="form-control bnpl-cost" value="0" readonly>
        </div>
    `;
    return div;
}

document.getElementById("addItemBtn").onclick = () => {
    const row = createItemRow();
    row.querySelector(".bnpl-item").addEventListener("change", e => {
        row.querySelector(".bnpl-cost").value = products[e.target.value];
    });
    document.getElementById("itemContainer").appendChild(row);
};

document.getElementById("addItemBtn").click();

// ADD LOG
document.getElementById("addLogBtn").onclick = () => {
    const name = document.getElementById("bnplName").value;
    const date = document.getElementById("bnplDate").value;

    document.querySelectorAll("#itemContainer .row").forEach(row => {
        const item = row.querySelector(".bnpl-item").value;
        const cost = row.querySelector(".bnpl-cost").value;

        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${name}</td>
            <td>${item}</td>
            <td>${cost}</td>
            <td>${date}</td>
            <td class="status">UNPAID</td>
            <td><button class="btn btn-warning btn-sm markPaid">Paid</button></td>
        `;
        document.querySelector("#bnplTable tbody").appendChild(tr);
    });
};

// MARK AS PAID (WITH PASSWORD)
document.addEventListener("click", function(e){
    if(e.target.classList.contains("markPaid")){
        const pw = prompt("Enter admin password:");
        if(pw === "bubi123"){
            e.target.closest("tr").querySelector(".status").textContent = "PAID";
            e.target.remove();
        } else {
            alert("Incorrect Password");
        }
    }
});

// SEARCH BNPL
document.getElementById("bnplSearchInput").addEventListener("keyup", function(){
    const value = this.value.toLowerCase();
    const rows = document.querySelectorAll("#bnplTable tbody tr");
    rows.forEach(tr => {
        tr.style.display = tr.textContent.toLowerCase().includes(value) ? "" : "none";
    });
});

// CSV DOWNLOAD
document.getElementById("downloadCsvBtn").onclick = () => {
    let csv = "Name,Item,Cost,Date,Status\n";
    const rows = document.querySelectorAll("#bnplTable tbody tr");
    rows.forEach(r => {
        const cols = r.querySelectorAll("td");
        csv += `${cols[0].innerText},${cols[1].innerText},${cols[2].innerText},${cols[3].innerText},${cols[4].innerText}\n`;
    });

    const blob = new Blob([csv], { type: "text/csv" });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "bnpl_logs.csv";
    a.click();
};
</script>

</body>
</html>
